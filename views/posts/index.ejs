<!DOCTYPE html>
<html>
    <head>
        <%- include('../partials/head') %>
    </head>
    <body>
        <%- include('../partials/nav') %>

        <div class="container post post-index">
            <%- include('./partials/header') %>

            <div class="buttons">
                <% if (isAuthenticated) { %>
                <a class="btn btn-default" href="/posts/new">New</a>
                <% } %>
            </div>

            <table class="table table-striped posts">
                <thead>
                    <tr>
                        <th class="title">Title</th>
                        <th class="author">Author</th>
                        <th class="date">Date</th>
                    </tr>
                </thead>
                <tbody>
                    <% if (posts == null || posts.length == 0) { %>
                        <tr>
                            <td class="noData" colspan="100"> There is no data to show :( </td>
                        </tr>
                    <% } %>
                    <% posts.forEach(function(post) { %>
                        <tr>
                            <td class="title">
                                <a href="/posts/<%= post._id %>"><div class="ellipsis"><%= post.title %></div></a>
                            </td>
                            <td class="author">
                                <div class="ellipsis"><%= post.author ? post.author.username : "" %></div>
                            </td>
                            <td class="date">
                                <%= post.createdDate %>
                            </td>
                        </tr>
                    <% }) %>        
                </tbody>
            </table>
            <!-- pagenation -->
            <ul class="pagenation_ul">
                <% let offset = 3; %>
                <% for (var i = 1; i <= maxPage; i++) { %>
                    <% if (i <= offset || i > (maxPage - offset) || (i >= page - (offset - 1)) && i <= page + (offset - 1)) { %>
                        <% if (i != page) { %>
                            <li>[<a href="/posts?page=<%= i %>"> <%= i %> </a>]</li>
                        <% } else { %>
                            <li>[ <b><%= i %></b> ]</li>
                        <% } %>
                    <% } else if (i == (offset + 1) || i == (maxPage - offset)) { %>
                        <li>...</li>
                    <% } %>
                <% } %>                    
            </ul>
            <!-- pagenation end -->

        </div> <!-- container end -->

    </body>
</html>